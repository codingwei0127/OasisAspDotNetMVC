
@{
    ViewBag.Title = "Identify";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <style>
        /* Basic styling */

        [type=checkbox] {
            width: 2rem;
            height: 2rem;
            color: dodgerblue;
            vertical-align: middle;
            -webkit-appearance: none;
            background: none;
            border: 0;
            outline: 0;
            flex-grow: 0;
            border-radius: 50%;
            background-color: #FFFFFF;
            transition: background 300ms;
            cursor: pointer;
        }


            /* Pseudo element for check styling */

            [type=checkbox]::before {
                content: "";
                color: transparent;
                display: block;
                width: inherit;
                height: inherit;
                border-radius: inherit;
                border: 0;
                background-color: transparent;
                background-size: contain;
                box-shadow: inset 0 0 0 1px #CCD3D8;
            }


            /* Checked */

            [type=checkbox]:checked {
                background-color: currentcolor;
            }

                [type=checkbox]:checked::before {
                    box-shadow: none;
                    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E %3Cpath d='M15.88 8.29L10 14.17l-1.88-1.88a.996.996 0 1 0-1.41 1.41l2.59 2.59c.39.39 1.02.39 1.41 0L17.3 9.7a.996.996 0 0 0 0-1.41c-.39-.39-1.03-.39-1.42 0z' fill='%23fff'/%3E %3C/svg%3E");
                }


            /* Disabled */

            [type=checkbox]:disabled {
                background-color: #CCD3D8;
                opacity: 0.84;
                cursor: not-allowed;
            }


            /* IE */

            [type=checkbox]::-ms-check {
                content: "";
                color: transparent;
                display: block;
                width: inherit;
                height: inherit;
                border-radius: inherit;
                border: 0;
                background-color: transparent;
                background-size: contain;
                box-shadow: inset 0 0 0 1px #CCD3D8;
            }

            [type=checkbox]:checked::-ms-check {
                box-shadow: none;
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E %3Cpath d='M15.88 8.29L10 14.17l-1.88-1.88a.996.996 0 1 0-1.41 1.41l2.59 2.59c.39.39 1.02.39 1.41 0L17.3 9.7a.996.996 0 0 0 0-1.41c-.39-.39-1.03-.39-1.42 0z' fill='%23fff'/%3E %3C/svg%3E");
            }
    </style>

</head>

<div class="row">
    <div class="col-md-12">
        <div class="card" style="background-color: #ffffff;">
            <div class="card-header card-header-icon card-header-info">
                <div class="card-icon">
                    <i class="material-icons">dvr</i>
                </div>

                <div class="row">
                    <div class="col-md-10">
                        <h4 class="card-title" style="font-weight:bold;color:#013d66;">影像空調控制</h4>
                    </div>
                    <div class="col-md-2" style="margin-top:5px">
                        <input id="thisisIdentify" onclick="button()" style="margin-bottom:5px"  type="checkbox" checked />
                        <label style="margin-top:10px;color:black;font-size: large;font-weight: bold;" for="switchIdentify">影像辨識開關</label>

                    </div>

                </div>

            </div>
            <div class="card-body">

                <div class="tab-content tab-space">
                    <div class="col-md-12 tab-pane active table-responsive" id="CHlink">
                        <div class="row">
                            <table class="col-md-12" id="Table_CH" style="font-weight:bold;text-align:center;color:black;">
                                <thead>
                                    <tr style="background-color:#036EB7;border-bottom:2px #000000 solid;border-top:2px #000000 solid;color:white;height:40px;">
                                        <th class="col-md-4" style="font-size:large">辨識時間</th>
                                        <th class="col-md-4" style="font-size:large">辨識人數</th>
                                        <th class="col-md-4" style="font-size:large">風量控制</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td id="Time_top1" style="background-color: #b2dbf7; font-size: large">上午11:00</td>
                                        <td id="People_top1" name="CHstatus" style="font-size: large; color: #000000 ">3</td>
                                        <td id="Speed_top1" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>

                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td id="Time_top2" style="background-color: #e3f4ff; font-size: large">上午10:55</td>
                                        <td id="People_top2" name="CHstatus" style="font-size: large; color: #000000 ">4</td>
                                        <td id="Speed_top2" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>


                                    </tr>
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td id="Time_top3" style="background-color: #b2dbf7; font-size: large">上午10:50</td>
                                        <td id="People_top3" name="CHstatus" style="font-size: large; color: #000000 ">5</td>
                                        <td id="Speed_top3" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>


                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td id="Time_top4" style="background-color: #e3f4ff; font-size: large">上午10:45</td>
                                        <td id="People_top4" name="CHstatus" style="font-size: large; color: #000000 ">4</td>
                                        <td id="Speed_top4" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>


                                    </tr>
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td id="Time_top5" style="background-color: #b2dbf7; font-size: large">上午10:40</td>
                                        <td id="People_top5" name="CHstatus" style="font-size: large; color: #000000 ">3</td>
                                        <td id="Speed_top5" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>


                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td id="Time_top6" style="background-color: #e3f4ff; font-size: large">上午10:35</td>
                                        <td id="People_top6" name="CHstatus" style="font-size: large; color: #000000 ">1</td>
                                        <td id="Speed_top6" name="CHstatus" style="font-size: large; color: #000000 ">弱風</td>


                                    </tr>
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td id="Time_top7" style="background-color: #b2dbf7; font-size: large">上午10:30</td>
                                        <td id="People_top7" name="CHstatus" style="font-size: large; color: #000000 ">3</td>
                                        <td id="Speed_top7" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>


                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td id="Time_top8" style="background-color: #e3f4ff; font-size: large">上午10:25</td>
                                        <td id="People_top8" name="CHstatus" style="font-size: large; color: #000000 ">4</td>
                                        <td id="Speed_top8" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>


                                    </tr>
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td id="Time_top9" style="background-color: #b2dbf7; font-size: large">上午10:20</td>
                                        <td id="People_top9" name="CHstatus" style="font-size: large; color: #000000 ">3</td>
                                        <td id="Speed_top9" name="CHstatus" style="font-size: large; color: #000000 ">微風</td>


                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td id="Time_top10" style="background-color: #e3f4ff; font-size: large">上午10:15</td>
                                        <td id="People_top10" name="CHstatus" style="font-size: large; color: #000000 ">6</td>
                                        <td id="Speed_top10" name="CHstatus" style="font-size: large; color: #000000 ">強風</td>

                                    </tr>

                                </tbody>
                            </table>
                        </div>
                        <br />

                        <div class="row">
                            <div class="chart-container col-md-11" id="ChartDIV">
                                <div id="CHdata"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 tab-pane table-responsive" id="Pumplink">
                        <div class="row">
                            <table class="col-md-12" id="Table_Pump" style="font-weight:bold;text-align:center;color:black;">
                                <thead id="CHPthead">
                                    <tr style="background-color:#1ba891;border-bottom:2px #000000 solid;border-top:2px #000000 solid;color:white;height:40px;">
                                        <th class="col-md-3">冰水泵浦</th>
                                        <th class="col-md-2">CHP1</th>
                                        <th class="col-md-2">CHP2</th>
                                        <th class="col-md-2">CHP3</th>
                                        <th class="col-md-2">CHPSP</th>
                                    </tr>
                                </thead>
                                <tbody id="CHPtbody">
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td style="background-color:#a5f2e5;">狀態</td>
                                        <td name="CHPstatus"></td>
                                        <td name="CHPstatus"></td>
                                        <td name="CHPstatus"></td>
                                        <td name="CHPstatus"></td>
                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td style="background-color:#e3f4ff;">運轉頻率(Hz)</td>
                                        <td name="CHPvalue"></td>
                                        <td name="CHPvalue"></td>
                                        <td name="CHPvalue"></td>
                                        <td name="CHPvalue"></td>
                                    </tr>
                                </tbody>
                                <thead id="CWPthead">
                                    <tr style="background-color:#1ba891;border-bottom:2px #000000 solid;border-top:2px #000000 solid;color:white;height:40px;">
                                        <th class="col-md-3">冷卻水泵浦</th>
                                        <th class="col-md-2">CWP1</th>
                                        <th class="col-md-2">CWP2</th>
                                        <th class="col-md-2">CWP3</th>
                                        <th class="col-md-2">CWPSP</th>
                                    </tr>
                                </thead>
                                <tbody id="CWPtbody">
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td style="background-color:#a5f2e5;">狀態</td>
                                        <td name="CWPstatus"></td>
                                        <td name="CWPstatus"></td>
                                        <td name="CWPstatus"></td>
                                        <td name="CWPstatus"></td>
                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td style="background-color:#e3f4ff;">運轉頻率(Hz)</td>
                                        <td name="CWPvalue"></td>
                                        <td name="CWPvalue"></td>
                                        <td name="CWPvalue"></td>
                                        <td name="CWPvalue"></td>
                                    </tr>
                                </tbody>
                                <thead id="ZPthead">
                                    <tr style="background-color:#1ba891;border-bottom:2px #000000 solid;border-top:2px #000000 solid;color:white;height:40px;">
                                        <th class="col-md-3">區域泵浦</th>
                                        <th class="col-md-2">ZP1</th>
                                        <th class="col-md-2">ZP2</th>
                                        <th class="col-md-2">ZP3</th>
                                        <th class="col-md-2">ZPSP</th>
                                    </tr>
                                </thead>
                                <tbody id="ZPtbody">
                                    <tr style="background-color:#EEEEEE;height:40px;">
                                        <td style="background-color:#a5f2e5;">狀態</td>
                                        <td name="ZPstatus"></td>
                                        <td name="ZPstatus"></td>
                                        <td name="ZPstatus"></td>
                                        <td name="ZPstatus"></td>
                                    </tr>
                                    <tr style="background-color:#FAFAFA;height:40px;">
                                        <td style="background-color:#e3f4ff;">運轉頻率(Hz)</td>
                                        <td name="ZPvalue"></td>
                                        <td name="ZPvalue"></td>
                                        <td name="ZPvalue"></td>
                                        <td name="ZPvalue"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-12 tab-pane table-responsive" id="CTlink">
                        <table class="col-md-12" id="Table_CT" style="font-weight:bold;text-align:center;color:black;">
                            <thead>
                                <tr style="background-color:rgb(238,135,75);border-bottom:2px #000000 solid;border-top:2px #000000 solid;color:white;height:40px;">
                                    <th class="col-md-4">冷卻水塔</th>
                                    <th class="col-md-4">狀態</th>
                                    <th class="col-md-4">運轉頻率(Hz)</th>
                                </tr>
                            </thead>
                            <tr style="background-color:#EEEEEE;height:40px;">
                                <td style="background-color:#ffc591;">CT1</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                            <tr style="background-color:#FAFAFA;height:40px;">
                                <td style="background-color:#fcecde;">CT2</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                            <tr style="background-color:#EEEEEE;height:40px;">
                                <td style="background-color:#ffc591;">CT3</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                            <tr style="background-color:#FAFAFA;height:40px;">
                                <td style="background-color:#fcecde;">CT4</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                            <tr style="background-color:#EEEEEE;height:40px;">
                                <td style="background-color:#ffc591;">CT5</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                            <tr style="background-color:#FAFAFA;height:40px;">
                                <td style="background-color:#fcecde;">CT6</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                            <tr style="background-color:#EEEEEE;height:40px;">
                                <td style="background-color:#ffc591;">CT7</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                            <tr style="background-color:#FAFAFA;height:40px;">
                                <td style="background-color:#fcecde;">CT8</td>
                                <td name="CTstatus"></td>
                                <td name="CTvalue"></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var whatisthis = 1; // 初始開
    var Id_identify = document.getElementById("thisisIdentify").checked;
    var ws = new WebSocket("ws://10.15.1.8:5001"); //指向server

    function button() { 

        if (Id_identify == 0) {
            ws.send('OK'); 
            Id_identify = 1;
        }
        else if (Id_identify == 1) {
            ws.send('NOTOK');
            Id_identify = 0;

        }
    }
</script>
<script>
    $.ajax({
        type: "POST",
        dataType: "json",
        url: "/Home/Identify_SQL",
        success: function (data) { 
            var Time = data[0].Time;
            var People = data[0].People;
            var Speed = data[0].Speed;

            var Plus12ToHour = function (date) {

                date = [...date];
                for (let x = 0; x <= 2; x++) {
                    date.splice(date.length - 1, 1,);
                }
                while (date[0] != '上' && date[0] != '下') {
                    date.splice(0, 1,);
                }
                date = date.join('');
                return date;
            }

            for (let x = 0; x <= Time.length - 1; x++) {
                Time[x] = Plus12ToHour(Time[x]);
            }

            for (let x = 0; x <= 9; x++) {
                let ajaxID = "Time_top" + (x + 1);
                document.getElementById(ajaxID).innerHTML = Time[x];
                ajaxID = "People_top" + (x + 1);
                document.getElementById(ajaxID).innerHTML = People[x];
                ajaxID = "Speed_top" + (x + 1);

                if (Speed[x] == 1) {
                    Speed[x] = '微風';
                }
                else if (Speed[x] == 3) {
                    Speed[x] = '弱風';
                }
                else if (Speed[x] == 4) {
                    Speed[x] = '強風';
                }

                document.getElementById(ajaxID).innerHTML = Speed[x];
            }
        }
    });
</script>